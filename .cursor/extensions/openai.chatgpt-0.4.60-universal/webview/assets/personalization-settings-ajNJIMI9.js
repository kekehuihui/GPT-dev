import{c as H,h as Q,i as q,k as A,r as I,d as U,e as G,j as s,a as D,M as o,S as K,B as T,l as $,m as J,n as O,f as W}from"./index-BANRepXe.js";function Y(){const e=H.c(37),t=Q(),i=q(),S=A(),[k,P]=I.useState(null);let u;e[0]===Symbol.for("react.memo_cache_sentinel")?(u={queryConfig:void 0},e[0]=u):u=e[0];const{data:z,error:V,isFetching:B,refetch:C}=U("codex-agents-md",u);let r;e[1]!==t||e[2]!==S||e[3]!==i?(r=(R,M)=>{S.setQueryData(O("codex-agents-md"),{path:R.path,contents:M.contents}),P(null),i.success(t.formatMessage({id:"settings.personalization.agents.save.success",defaultMessage:"Saved agents.md",description:"Toast shown when agents.md is saved"}))},e[1]=t,e[2]=S,e[3]=i,e[4]=r):r=e[4];let l;e[5]!==t||e[6]!==i?(l=()=>{i.danger(t.formatMessage({id:"settings.personalization.agents.save.error",defaultMessage:"Unable to save agents.md",description:"Toast shown when agents.md save fails"}))},e[5]=t,e[6]=i,e[7]=l):l=e[7];let m;e[8]!==r||e[9]!==l?(m={onSuccess:r,onError:l},e[8]=r,e[9]=l,e[10]=m):m=e[10];const x=G("codex-agents-md-save",m),g=z?.contents??"",d=k??g,c=k!=null&&k!==g,n=z!=null,N=!n&&B,a=x.isPending,w=V!=null&&z==null;let f;e[11]!==d||e[12]!==c||e[13]!==n||e[14]!==a||e[15]!==x?(f=()=>{!n||!c||a||x.mutate({contents:d})},e[11]=d,e[12]=c,e[13]=n,e[14]=a,e[15]=x,e[16]=f):f=e[16];const E=f;let p;e[17]!==C?(p=()=>{C()},e[17]=C,e[18]=p):p=e[18];const L=p;let h;e[19]!==t?(h=t.formatMessage({id:"settings.personalization.agents.placeholder",defaultMessage:"Add your custom instructions…",description:"Placeholder text for personal agents editor"}),e[19]=t,e[20]=h):h=e[20];const _=h;let y;e[21]!==t?(y=t.formatMessage({id:"settings.personalization.agents.title",defaultMessage:"Custom instructions",description:"Heading for personal agents settings section"}),e[21]=t,e[22]=y):y=e[22];const F=y;let j;e[23]===Symbol.for("react.memo_cache_sentinel")?(j=s.jsx(W,{slug:"personalization",messagePrefix:"settings.section"}),e[23]=j):j=e[23];let v;e[24]===Symbol.for("react.memo_cache_sentinel")?(v=s.jsx(D.Header,{title:s.jsx(o,{id:"settings.personalization.agents.title",defaultMessage:"Custom instructions",description:"Heading for personal agents settings section"})}),e[24]=v):v=e[24];let b;return e[25]!==g||e[26]!==F||e[27]!==d||e[28]!==L||e[29]!==E||e[30]!==c||e[31]!==N||e[32]!==n||e[33]!==a||e[34]!==_||e[35]!==w?(b=s.jsx(K,{title:j,children:s.jsxs(D,{children:[v,s.jsx(D.Content,{children:w?s.jsxs("div",{className:"flex items-center justify-between gap-3",children:[s.jsx("div",{className:"text-token-text-secondary text-sm",children:s.jsx(o,{id:"settings.personalization.agents.loadError",defaultMessage:"Unable to load agents.md.",description:"Error message shown when agents.md fails to load"})}),s.jsx(T,{className:"shrink-0",color:"secondary",onClick:L,size:"toolbar",children:s.jsx(o,{id:"settings.personalization.agents.retry",defaultMessage:"Retry",description:"Button label to retry loading agents.md"})})]}):s.jsxs("div",{className:"flex flex-col gap-3",children:[s.jsx("div",{className:"text-token-text-secondary text-sm",children:s.jsx(o,{id:"settings.personalization.agents.description",defaultMessage:"Edit instructions that tailor Codex to you. {learnMore}",description:"Description for personal agents settings",values:{learnMore:s.jsxs("a",{className:"text-token-text-secondary hover:text-token-text-primary inline-flex items-center gap-1 text-sm",href:"https://developers.openai.com/codex/guides/agents-md/#create-global-guidance",target:"_blank",rel:"noreferrer",children:[s.jsx(o,{id:"settings.personalization.agents.learnMore",defaultMessage:"Learn more",description:"Link label for agents.md docs"}),s.jsx($,{className:"icon-xxs"})]})}})}),N?s.jsxs("div",{className:"text-token-text-secondary flex items-center gap-2 text-sm",children:[s.jsx(J,{className:"icon-xs"}),s.jsx(o,{id:"settings.personalization.agents.loading",defaultMessage:"Loading agents.md…",description:"Loading label for agents.md editor"})]}):s.jsx("textarea",{"aria-label":F,id:"personal-agents-editor",className:"bg-token-input-background text-token-text-primary font-mono w-full rounded-md border border-token-border px-2.5 py-2 text-sm outline-none focus-visible:ring-2 focus-visible:ring-token-focus",disabled:!n||a,placeholder:_,rows:12,value:d,onChange:R=>{const M=R.target.value;P(M===g?null:M)}}),s.jsx("div",{className:"flex items-center justify-end gap-2",children:s.jsx(T,{color:"primary",disabled:!c||!n,loading:a,onClick:E,size:"toolbar",children:s.jsx(o,{id:"settings.personalization.agents.save",defaultMessage:"Save",description:"Save button label for personal agents editor"})})})]})})]})}),e[25]=g,e[26]=F,e[27]=d,e[28]=L,e[29]=E,e[30]=c,e[31]=N,e[32]=n,e[33]=a,e[34]=_,e[35]=w,e[36]=b):b=e[36],b}export{Y as PersonalizationSettings};
